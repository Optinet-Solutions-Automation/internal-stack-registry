(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[628],{8971:function(e,t,r){Promise.resolve().then(r.bind(r,7865))},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return l.a}});var s=r(2972),l=r.n(s)},2119:function(e,t,r){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return l}});let s=r(3079);function l(e){let{createServerReference:t}=r(6671);return t(e,s.callServer)}},7865:function(e,t,r){"use strict";r.d(t,{default:function(){return g}});var s=r(7437),l=r(2265),a=r(7648);r(3079);var n=(0,r(2119).$)("3670185253f71efaab779c07c78614f02404a959");let i="w-full bg-gray-800 border border-gray-700 text-gray-200 text-sm rounded-lg px-3 py-2 focus:outline-none focus:border-indigo-500 placeholder-gray-600";function o(e){let{label:t,children:r}=e;return(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-400",children:t}),r]})}let d=new Date,c="".concat(d.getFullYear(),"-").concat(String(d.getMonth()+1).padStart(2,"0"),"-01");function x(e){var t;let{tools:r,onClose:a}=e,[d,x]=(0,l.useState)({tool_id:"",month:c,usage_amount:0,currency:"USD",budget_limit:null}),[u,m]=(0,l.useState)(!1),[g,h]=(0,l.useState)(null),p=(e,t)=>x(r=>({...r,[e]:t})),b=async e=>{if(e.preventDefault(),!d.tool_id)return;m(!0),h(null);let t=await n(d);m(!1),t.error?h(t.error):a()};return(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl w-full max-w-md mx-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-5 border-b border-gray-800",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Log Usage"}),(0,s.jsx)("button",{onClick:a,className:"text-gray-500 hover:text-white transition-colors text-xl leading-none",children:"\xd7"})]}),(0,s.jsxs)("form",{onSubmit:b,className:"px-6 py-5 space-y-4",children:[g&&(0,s.jsx)("div",{className:"bg-red-900/40 border border-red-800 text-red-300 text-sm rounded-lg px-4 py-3",children:g}),(0,s.jsx)(o,{label:"Tool *",children:(0,s.jsxs)("select",{value:d.tool_id,onChange:e=>p("tool_id",e.target.value),required:!0,className:i,children:[(0,s.jsx)("option",{value:"",children:"Select a tool..."}),r.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,s.jsx)(o,{label:"Month *",children:(0,s.jsx)("input",{type:"month",value:d.month.slice(0,7),onChange:e=>p("month","".concat(e.target.value,"-01")),required:!0,className:i})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(o,{label:"Usage Amount *",children:(0,s.jsx)("input",{type:"number",step:"0.0001",min:"0",required:!0,value:d.usage_amount,onChange:e=>p("usage_amount",parseFloat(e.target.value)||0),className:i})}),(0,s.jsx)(o,{label:"Currency",children:(0,s.jsxs)("select",{value:d.currency,onChange:e=>p("currency",e.target.value),className:i,children:[(0,s.jsx)("option",{value:"USD",children:"USD"}),(0,s.jsx)("option",{value:"PHP",children:"PHP"}),(0,s.jsx)("option",{value:"EUR",children:"EUR"})]})})]}),(0,s.jsx)(o,{label:"Budget Limit",children:(0,s.jsx)("input",{type:"number",step:"0.01",min:"0",value:null!==(t=d.budget_limit)&&void 0!==t?t:"",onChange:e=>p("budget_limit",e.target.value?parseFloat(e.target.value):null),placeholder:"Optional",className:i})}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"If an entry already exists for this tool + month, it will be updated."}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:u,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white text-sm font-medium rounded-lg transition-colors",children:u?"Saving...":"Log Usage"})]})]})]})})}function u(e){let{usage:t,limit:r}=e;if(!r)return(0,s.jsx)("span",{className:"text-gray-500 text-xs",children:"No limit set"});let l=Math.min(t/r*100,100),a=t>r;return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"flex-1 h-1.5 bg-gray-800 rounded-full overflow-hidden min-w-16",children:(0,s.jsx)("div",{className:"h-full rounded-full ".concat(a?"bg-red-500":l>=80?"bg-yellow-500":"bg-indigo-500"),style:{width:"".concat(l,"%")}})}),(0,s.jsxs)("span",{className:"text-xs font-medium w-10 text-right ".concat(a?"text-red-400":l>=80?"text-yellow-400":"text-gray-400"),children:[l.toFixed(0),"%"]})]})}function m(e){return new Date(e).toLocaleDateString("en-US",{month:"short",year:"numeric"})}function g(e){let{usageLogs:t,tools:r}=e,[n,i]=(0,l.useState)(!1),[o,d]=(0,l.useState)(""),[c,g]=(0,l.useState)(""),h=[...new Set(t.map(e=>e.month.slice(0,7)))].sort().reverse(),p=[...new Set(t.map(e=>{var t;return null===(t=e.tools)||void 0===t?void 0:t.name}).filter(Boolean))],b=new Date().toISOString().slice(0,7),y=t.filter(e=>e.month.startsWith(b)),j=y.reduce((e,t)=>e+Number(t.usage_amount),0),f=y.filter(e=>e.budget_limit&&Number(e.usage_amount)>Number(e.budget_limit)).length,N=t.filter(e=>{var t;return(!o||(null===(t=e.tools)||void 0===t?void 0:t.name)===o)&&(!c||!!e.month.startsWith(c))});return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Usage"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-400",children:"Monthly usage tracking and budget monitoring"})]}),(0,s.jsx)("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium rounded-lg transition-colors",children:"+ Log Usage"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"This Month Spend"}),(0,s.jsx)("p",{className:"mt-1.5 text-xl font-bold text-white",children:j>0?"USD ".concat(j.toFixed(2)):"—"})]}),(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Over Budget"}),(0,s.jsx)("p",{className:"mt-1.5 text-xl font-bold ".concat(f>0?"text-red-400":"text-white"),children:f})]}),(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Total Entries"}),(0,s.jsx)("p",{className:"mt-1.5 text-xl font-bold text-white",children:t.length})]})]}),f>0&&(0,s.jsxs)("div",{className:"bg-red-900/30 border border-red-800 rounded-xl px-5 py-4 flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-red-400 text-lg",children:"⚠"}),(0,s.jsxs)("p",{className:"text-sm font-semibold text-red-300",children:[f," tool",f>1?"s":""," exceeded budget this month"]})]}),(0,s.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,s.jsxs)("select",{value:o,onChange:e=>d(e.target.value),className:"bg-gray-900 border border-gray-700 text-gray-300 text-sm rounded-lg px-3 py-2 focus:outline-none focus:border-indigo-500",children:[(0,s.jsx)("option",{value:"",children:"All Tools"}),p.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),(0,s.jsxs)("select",{value:c,onChange:e=>g(e.target.value),className:"bg-gray-900 border border-gray-700 text-gray-300 text-sm rounded-lg px-3 py-2 focus:outline-none focus:border-indigo-500",children:[(0,s.jsx)("option",{value:"",children:"All Months"}),h.map(e=>(0,s.jsx)("option",{value:e,children:m("".concat(e,"-01"))},e))]}),(o||c)&&(0,s.jsx)("button",{onClick:()=>{d(""),g("")},className:"text-sm text-gray-400 hover:text-white px-3 py-2 transition-colors",children:"Clear"})]}),(0,s.jsx)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl overflow-hidden",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{className:"border-b border-gray-800",children:["Tool","Month","Usage Amount","Budget Limit","Budget Used","Currency"].map(e=>(0,s.jsx)("th",{className:"text-left px-5 py-3.5 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:e},e))})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-800",children:0===N.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:6,className:"px-5 py-10 text-center text-gray-500",children:"No usage data found"})}):N.map(e=>{let t=e.budget_limit&&Number(e.usage_amount)>Number(e.budget_limit);return(0,s.jsxs)("tr",{className:"hover:bg-gray-800/50 transition-colors ".concat(t?"bg-red-950/20":""),children:[(0,s.jsx)("td",{className:"px-5 py-4",children:e.tools?(0,s.jsx)(a.default,{href:"/tools/".concat(e.tools.id),className:"font-medium text-indigo-400 hover:text-indigo-300",children:e.tools.name}):"—"}),(0,s.jsx)("td",{className:"px-5 py-4 text-gray-300",children:m(e.month)}),(0,s.jsx)("td",{className:"px-5 py-4",children:(0,s.jsx)("span",{className:"font-semibold ".concat(t?"text-red-400":"text-white"),children:Number(e.usage_amount).toFixed(4)})}),(0,s.jsx)("td",{className:"px-5 py-4 text-gray-400",children:e.budget_limit?Number(e.budget_limit).toFixed(2):"—"}),(0,s.jsx)("td",{className:"px-5 py-4 w-40",children:(0,s.jsx)(u,{usage:Number(e.usage_amount),limit:e.budget_limit?Number(e.budget_limit):null})}),(0,s.jsx)("td",{className:"px-5 py-4 text-gray-400",children:e.currency})]},e.id)})})]})}),n&&(0,s.jsx)(x,{tools:r,onClose:()=>i(!1)})]})}}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=8971)}),_N_E=e.O()}]);