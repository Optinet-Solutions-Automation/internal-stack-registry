(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[681],{1067:function(e,t,l){Promise.resolve().then(l.bind(l,4255))},7648:function(e,t,l){"use strict";l.d(t,{default:function(){return a.a}});var s=l(2972),a=l.n(s)},2119:function(e,t,l){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return a}});let s=l(3079);function a(e){let{createServerReference:t}=l(6671);return t(e,s.callServer)}},4255:function(e,t,l){"use strict";l.d(t,{default:function(){return g}});var s=l(7437),a=l(2265),r=l(7648);l(3079);var n=(0,l(2119).$)("6531035d583b8397b205eebde12e022853ea8ad6");let o="w-full bg-gray-800 border border-gray-700 text-gray-200 text-sm rounded-lg px-3 py-2 focus:outline-none focus:border-indigo-500 placeholder-gray-600";function i(e){let{label:t,children:l}=e;return(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("label",{className:"block text-xs font-medium text-gray-400",children:t}),l]})}let d=["SSO","API Key","Username / Password","OAuth","Service Account","MFA Token"],c={tool_id:"",login_type:"",credential_location:"",last_rotated:"",rotation_policy:"",owner:"",compliance_notes:""};function x(e){let{tools:t,onClose:l}=e,[r,x]=(0,a.useState)(c),[p,u]=(0,a.useState)(!1),[g,m]=(0,a.useState)(null),h=(e,t)=>x(l=>({...l,[e]:t})),y=async e=>{if(e.preventDefault(),!r.tool_id)return;u(!0),m(null);let t=await n(r);u(!1),t.error?m(t.error):l()};return(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-5 border-b border-gray-800",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Add Credential Reference"}),(0,s.jsx)("button",{onClick:l,className:"text-gray-500 hover:text-white transition-colors text-xl leading-none",children:"\xd7"})]}),(0,s.jsx)("div",{className:"px-5 py-3 bg-gray-800/50 border-b border-gray-800",children:(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"⚠ Never enter raw passwords. Store only references to where credentials are kept (e.g. vault paths, 1Password entries)."})}),(0,s.jsxs)("form",{onSubmit:y,className:"px-6 py-5 space-y-4",children:[g&&(0,s.jsx)("div",{className:"bg-red-900/40 border border-red-800 text-red-300 text-sm rounded-lg px-4 py-3",children:g}),(0,s.jsx)(i,{label:"Tool *",children:(0,s.jsxs)("select",{value:r.tool_id,onChange:e=>h("tool_id",e.target.value),required:!0,className:o,children:[(0,s.jsx)("option",{value:"",children:"Select a tool..."}),t.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(i,{label:"Login Type",children:(0,s.jsxs)("select",{value:r.login_type,onChange:e=>h("login_type",e.target.value),className:o,children:[(0,s.jsx)("option",{value:"",children:"Select..."}),d.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})}),(0,s.jsx)(i,{label:"Owner",children:(0,s.jsx)("input",{type:"text",value:r.owner,onChange:e=>h("owner",e.target.value),placeholder:"e.g. DevOps",className:o})})]}),(0,s.jsx)(i,{label:"Credential Location",children:(0,s.jsx)("input",{type:"text",value:r.credential_location,onChange:e=>h("credential_location",e.target.value),placeholder:"e.g. 1Password > Vercel API Keys",className:o})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(i,{label:"Last Rotated",children:(0,s.jsx)("input",{type:"date",value:r.last_rotated,onChange:e=>h("last_rotated",e.target.value),className:o})}),(0,s.jsx)(i,{label:"Rotation Policy",children:(0,s.jsx)("input",{type:"text",value:r.rotation_policy,onChange:e=>h("rotation_policy",e.target.value),placeholder:"e.g. Every 90 days",className:o})})]}),(0,s.jsx)(i,{label:"Compliance Notes",children:(0,s.jsx)("textarea",{value:r.compliance_notes,onChange:e=>h("compliance_notes",e.target.value),rows:2,placeholder:"Optional compliance or access notes",className:"".concat(o," resize-none")})}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,s.jsx)("button",{type:"button",onClick:l,className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:p,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 text-white text-sm font-medium rounded-lg transition-colors",children:p?"Saving...":"Add Reference"})]})]})]})})}function p(e){return e?Math.floor((new Date().getTime()-new Date(e).getTime())/864e5):null}function u(e){let{lastRotated:t,policy:l}=e,a=p(t);if(!t)return(0,s.jsx)("span",{className:"text-gray-500",children:"Never rotated"});let r=new Date(t).toLocaleDateString(),n=null==l?void 0:l.match(/(\d+)/),o=n?parseInt(n[1]):null;return o&&null!==a&&a>o?(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-red-400 font-medium",children:r}),(0,s.jsxs)("span",{className:"ml-2 text-xs text-red-400",children:["(",a,"d ago — overdue)"]})]}):o&&null!==a&&a>.8*o?(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-yellow-400 font-medium",children:r}),(0,s.jsxs)("span",{className:"ml-2 text-xs text-yellow-400",children:["(",a,"d ago)"]})]}):(0,s.jsxs)("span",{className:"text-gray-300",children:[r," ",(0,s.jsxs)("span",{className:"text-gray-500 text-xs",children:["(",a,"d ago)"]})]})}function g(e){let{credentials:t,tools:l}=e,[n,o]=(0,a.useState)(!1),[i,d]=(0,a.useState)(""),c=[...new Set(t.map(e=>e.login_type).filter(Boolean))],g=t.filter(e=>!i||e.login_type===i),m=t.filter(e=>{var t;let l=p(e.last_rotated),s=null===(t=e.rotation_policy)||void 0===t?void 0:t.match(/(\d+)/),a=s?parseInt(s[1]):null;return null!==l&&null!==a&&l>a}).length;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Credentials"}),(0,s.jsxs)("p",{className:"mt-1 text-sm text-gray-400",children:[t.length," credential references — no raw passwords stored"]})]}),(0,s.jsx)("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium rounded-lg transition-colors",children:"+ Add Reference"})]}),m>0&&(0,s.jsxs)("div",{className:"bg-red-900/30 border border-red-800 rounded-xl px-5 py-4 flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-red-400 text-lg",children:"⚠"}),(0,s.jsxs)("p",{className:"text-sm font-semibold text-red-300",children:[m," credential",m>1?"s":""," overdue for rotation"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Total References"}),(0,s.jsx)("p",{className:"mt-1.5 text-xl font-bold text-white",children:t.length})]}),(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Overdue Rotation"}),(0,s.jsx)("p",{className:"mt-1.5 text-xl font-bold ".concat(m>0?"text-red-400":"text-white"),children:m})]}),(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Never Rotated"}),(0,s.jsx)("p",{className:"mt-1.5 text-xl font-bold text-white",children:t.filter(e=>!e.last_rotated).length})]})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)("select",{value:i,onChange:e=>d(e.target.value),className:"bg-gray-900 border border-gray-700 text-gray-300 text-sm rounded-lg px-3 py-2 focus:outline-none focus:border-indigo-500",children:[(0,s.jsx)("option",{value:"",children:"All Login Types"}),c.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),i&&(0,s.jsx)("button",{onClick:()=>d(""),className:"text-sm text-gray-400 hover:text-white px-3 py-2 transition-colors",children:"Clear"})]}),(0,s.jsx)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl overflow-hidden",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{className:"border-b border-gray-800",children:["Tool","Login Type","Credential Location","Owner","Rotation Policy","Last Rotated"].map(e=>(0,s.jsx)("th",{className:"text-left px-5 py-3.5 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:e},e))})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-800",children:0===g.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:6,className:"px-5 py-10 text-center text-gray-500",children:"No credentials found"})}):g.map(e=>{var t,l,a;return(0,s.jsxs)("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[(0,s.jsx)("td",{className:"px-5 py-4",children:e.tools?(0,s.jsx)(r.default,{href:"/tools/".concat(e.tools.id),className:"font-medium text-indigo-400 hover:text-indigo-300",children:e.tools.name}):"—"}),(0,s.jsx)("td",{className:"px-5 py-4",children:e.login_type?(0,s.jsx)("span",{className:"inline-flex px-2 py-0.5 rounded-full text-xs font-medium bg-gray-800 text-gray-300",children:e.login_type}):"—"}),(0,s.jsx)("td",{className:"px-5 py-4 text-gray-300 font-mono text-xs",children:null!==(t=e.credential_location)&&void 0!==t?t:"—"}),(0,s.jsx)("td",{className:"px-5 py-4 text-gray-400",children:null!==(l=e.owner)&&void 0!==l?l:"—"}),(0,s.jsx)("td",{className:"px-5 py-4 text-gray-400 text-xs",children:null!==(a=e.rotation_policy)&&void 0!==a?a:"—"}),(0,s.jsx)("td",{className:"px-5 py-4",children:(0,s.jsx)(u,{lastRotated:e.last_rotated,policy:e.rotation_policy})})]},e.id)})})]})}),n&&(0,s.jsx)(x,{tools:l,onClose:()=>o(!1)})]})}}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=1067)}),_N_E=e.O()}]);